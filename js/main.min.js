/*!
 * Trello Quick Notes Javascript
 * http://charleshalliday.com/qntrello
 *
 * Copyright 2012 Halliday Websites
 * Do what you like with this code, it's your funeral
 *
 * Date: Late September 2012
 */
var onAuthorize=function(){updateLoggedIn();
$(".boardlist").empty();Trello.members.get("me",function(b){$(".fullName").text(b.fullName);var a=$("<div>").text("Loading boards...").appendTo(".boardlist").after('<li class="listslist"><p>Choose a list</p></li>');
Trello.get("members/my/boards/all",function(c){a.empty();$.each(c,function(d,e){if(e.closed===false){$("<div>").attr("onClick",'getLists($(this),"'+e.id+'");').addClass("board").addClass(e.id).text(e.name).appendTo(a);
console.log(e.id);}});$("."+localStorage.setBoard).click();});});};var hideOthers=function(a){$("."+a).each(function(){$this=$(this);$this.slideUp("slow");
});};var saveList=function(a,b){localStorage.setList=b;a.removeClass("list").addClass("currentList");hideOthers("list");};var getLists=function(a,c){localStorage.setBoard=c;
a.removeClass("board").addClass("currentBoard");hideOthers("board");var b=$("<div>").text("Loading lists...").appendTo(".listslist");Trello.get("boards/"+c+"/lists",function(d){b.empty();
$.each(d,function(e,f){if(f.closed===false){if(f.idBoard===c){$("<div>").addClass("list").addClass(f.id).attr("onClick",'saveList($(this),"'+f.id+'");getCards();').text(f.name).appendTo(b);
console.log(f.id);}}});$("."+localStorage.setList).click();});};var getCards=function(){var a=localStorage.setList;$(".cardslist").html("");Trello.get("lists/"+a+"/cards",function(b){$.each(b,function(c,d){if(d.closed===false){$("<li>").addClass("cardinlist").addClass(b.id).text(d.name).appendTo($(".cardslist"));
}});console.log(b);});};var resetSelections=function(){delete localStorage.setBoard;delete localStorage.setList;onAuthorize();};var updateLoggedIn=function(){var a=Trello.authorized();
$(".loggedout").toggle(!a);$(".loggedin").toggle(a);};var logout=function(){Trello.deauthorize();updateLoggedIn();$("#output").remove();window.location.reload(true);
};create_card_with_parameters=function(b,c,a){Trello.post("cards",{name:b,desc:c,idList:a});show_feedback();};show_feedback=function(){$('input[type="text"]').each(function(){$(this).val("");
});getCards();};Trello.authorize({interactive:false,scope:{read:true,write:true},success:onAuthorize});$("#connectLink").click(function(){Trello.authorize({type:"popup",scope:{read:true,write:true},success:onAuthorize,name:"Quick-Notes-for-Trello"});
});$(".resetSelections").on("click",resetSelections);$("#disconnect").click(logout);$("#submitcard").click(function(){create_card_with_parameters($("#cardtitle").val(),$("#carddescription").val(),localStorage.setList);
});